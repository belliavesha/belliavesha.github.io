<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collatz Tree Visualizer</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="sidebar">
    <!-- Top Buttons -->
    <div class="top-buttons">
        <button id="renderBtn">Build Trees</button>
        <button id="fitBtn">Fit to Screen</button>
    </div>

    <!-- Main Two-Column Layout -->
    <div class="panel-grid">
        <!-- Left Column: Sample Parameters -->
        <div class="control-col">
            <div class="panel-section">
                <h3>Sample</h3>
                <div class="control-group">
                    <label for="sampleSize">Number of samples</label>
                    <input type="number" id="sampleSize" value="500">
                </div>
                <div class="control-group">
                    <label for="minValue">Lower limit</label>
                    <input type="number" id="minValue" value="200000">
                </div>
                <div class="control-group">
                    <label for="rangeValue">Range</label>
                    <input type="number" id="rangeValue" value="10000">
                </div>
            </div>
        </div>

        <!-- Right Column: Root/Render Parameters -->
        <div class="control-col">
            <div class="panel-section">
                <h3>Root</h3>
                <div class="control-group">
                    <label for="treeSelect">Select Tree</label>
                    <select id="treeSelect" disabled><option>Build first...</option></select>
                </div>
                <div class="control-group">
                    <label for="startValue">Start Value</label>
                    <input type="number" id="startValue" placeholder="Value" value="1">
                </div>
            </div>
        </div>
    </div>

    <hr style="border: 0; border-top: 1px solid #444; margin: 10px 0; width: 100%;">

    <!-- Rules and Angles Header/Initial Row -->
    <div class="panel-grid">
        <div class="control-group">
            <label for="modulus">Modulus (Rules)</label>
            <input type="number" id="modulus" value="2" min="2">
        </div>
        <div class="control-group knob-control">
            <label>Initial Angle</label>
            <div id="initAngleKnob" class="knob-container" data-target="initAngle" data-min="-180" data-max="180" data-value="0"></div>
            <input type="range" id="initAngle" min="-180" max="180" step="0.1" value="0" class="hidden-slider">
        </div>
    </div>

    <!-- Dynamic Rules and Angles Container -->
    <div id="dynamic-grid" class="panel-grid">
        <!-- Generated content: Rule Input | Angle Knob -->
    </div>
    
    <div class="legend" style="margin-top: 20px;">
        <div class="legend-item"><span class="box" style="background:#9b59b6"></span> Root</div>
        <div class="legend-item"><span class="box" style="background:#4facfa"></span> Cycle start</div>
        <div class="legend-item"><span class="box" style="background:#2ecc71"></span> Longest</div>
        <div class="legend-item"><span class="box" style="background:#d15858"></span> Highest</div>
        <div class="legend-item"><span class="box" style="background:#f1c40f"></span> Smallest</div>
        <div class="legend-item"><span class="box" style="background:#ff8c00"></span> Highlighted</div>
    </div>
    
    <!-- <div style="margin-top: auto; font-size: 0.7rem; color: #666;">
        Check console for debug output.
        Scroll to zoom. Drag to pan.
    </div> -->
</div>

<div id="canvas-container">
    <canvas id="mainCanvas"></canvas>
    <div id="labels-container"></div>
    <div id="tooltip"></div>
    <div id="loading">Processing...</div>
</div>

<script src="tree_math.js"></script>
<script src="tree_ui.js"></script>
</body>
</html>
